<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yinxt.surveyscale.mapper.PatientInfoMapper">

    <resultMap id="patientInfoResultMap" type="com.yinxt.surveyscale.pojo.PatientInfo">
        <result column="patient_id" property="patientId"/>
        <result column="patient_name" property="name"/>
        <result column="gender" property="gender"/>
        <result column="birthday" property="birthday"/>
        <result column="telephone_number" property="telephoneNumber"/>
        <result column="family_address" property="familyAddress"/>
    </resultMap>

    <select id="selectPatientInfo" parameterType="com.yinxt.surveyscale.pojo.PatientInfo"
            resultMap="patientInfoResultMap">
        select *
        from tb_patient_info
        <where>
            <if test="patientId != null and patientId != ''">
                patient_id=#{patientId,jdbcType=VARCHAR}
            </if>
            <if test="name != null and name != ''">
                and patient_name=#{name,jdbcType=VARCHAR}
            </if>
        </where>
    </select>

    <select id="selectPatientInfoByPatientId" resultMap="patientInfoResultMap">
        select *
        from tb_patient_info
        <where>
            patient_id=#{patientId,jdbcType=VARCHAR}
        </where>
    </select>

    <select id="selectPatientInfoList" parameterType="com.yinxt.surveyscale.pojo.PatientInfo"
            resultMap="patientInfoResultMap">
        select *
        from tb_patient_info
        <where>
            status = '1'
            <if test="dto != null and dto.name != null and dto.name != ''">
                and patient_name = #{dto.name,jdbcType=VARCHAR}
            </if>
            <if test="dto != null and dto.telephoneNumber != null and dto.telephoneNumber != ''">
                and telephone_number=#{dto.telephoneNumber,jdbcType=VARCHAR}
            </if>
        </where>
        order by create_time desc
    </select>

    <insert id="insertPatientInfo" parameterType="com.yinxt.surveyscale.pojo.PatientInfo">
        insert into tb_patient_info
--         (patient_id, patient_name, gender, birthday, telephone_number, family_address, create_time, na)
          (patient_id, patient_name, gender, birthday, telephone_number, family_address, create_time,
          nation, marriage_status, work_status, in_service_job, education_level, education_year, is_snoring,
          living_way, medical_history, other_medical_hository, smoking_hosihory, smoking_num_eachday,
          is_mental_disease_family_history, mental_disease_family_history, other_mental_disease_family_history,
          current_medical_history_memory_loss, memory_loss_time, physical_examination, is_use_cognitive_drugs,
          drugs_dosage, hand, drinking_history, drinking_type, drinking_um_eachday, drinking_years, drugs_type)
        values (
        #{patientId,jdbcType=VARCHAR},
        #{name,jdbcType=VARCHAR},
        #{gender,jdbcType=INTEGER},
        #{birthday, jdbcType=DATE},
        #{telephoneNumber,jdbcType=VARCHAR},
        #{familyAddress,jdbcType=VARCHAR},
        now(),
        #{nation,jdbcType=VARCHAR}, #{marriageStatus,jdbcType=VARCHAR}, #{inServiceJob,jdbcType=VARCHAR}, #{educationLevel,jdbcType=VARCHAR},
        #{educationYears,jdbcType=VARCHAR},#{isSnoring,jdbcType=VARCHAR},#{livingWay,jdbcType=VARCHAR},#{medicalHistory,jdbcType=VARCHAR},
        #{otherMedicalHistory,jdbcType=VARCHAR},#{smokingHistory,jdbcType=VARCHAR},
        #{smokingNumEachDay,jdbcType=VARCHAR},#{smokingYears,jdbcType=VARCHAR},#{isMentalDiseaseFamilyHistory,jdbcType=VARCHAR},
        #{mentalDiseaseFamilyHistory,jdbcType=VARCHAR},#{otherMentalDiseaseFamilyHistory,jdbcType=VARCHAR},
        #{currentMedicalHistoryMemoryLoss,jdbcType=VARCHAR},#{memoryLossTime,jdbcType=VARCHAR},#{physicalExamination,jdbcType=VARCHAR},
        #{isUseCognitiveDrugs,jdbcType=VARCHAR},#{drugsDosage,jdbcType=VARCHAR},#{hand,jdbcType=VARCHAR},
        #{drinkingHistory,jdbcType=VARCHAR},#{drinkingType,jdbcType=VARCHAR},#{drinkingNumEachDay,jdbcType=VARCHAR},
        #{drinkingYears,jdbcType=VARCHAR},#{drugsType,jdbcType=VARCHAR}
        )
    </insert>

    <update id="updatePatientInfo" parameterType="com.yinxt.surveyscale.pojo.PatientInfo">
        update tb_patient_info
        <set>
            <if test="name != null and name != ''">
                patient_name=#{name,jdbcType=VARCHAR},
            </if>
            <if test="gender != null and gender != ''">
                gender=#{gender,jdbcType=VARCHAR},
            </if>
            <if test="telephoneNumber != null and telephoneNumber != ''">
                birthday=#{birthday,jdbcType=DATE},
            </if>
            <if test="telephoneNumber != null and telephoneNumber != ''">
                telephone_number=#{telephoneNumber,jdbcType=VARCHAR},
            </if>
            <if test="familyAddress != null and familyAddress != ''">
                family_address=#{familyAddress,jdbcType=VARCHAR},
            </if>
            <if test="status != null and status != ''">
                status = #{status, jdbcType=VARCHAR},
            </if>
            <if test="nation != null">
                nation = #{nation, jdbcType=VARCHAR},
            </if>
            <if test="marriageStatus != null">
                marriage_status = #{marriageStatus, jdbcType=VARCHAR},
            </if>
            <if test="inServiceJob != null">
                in_service_job = #{inServiceJob,jdbcType=VARCHAR},
            </if>
            <if test="educationLevel != null">
                education_level = #{educationLevel,jdbcType=VARCHAR},
            </if>
            <if test="educationYears != null">
                education_years = #{educationYears,jdbcType=VARCHAR},
            </if>
            <if test="isSnoring != null">
                is_snoring != #{isSnoring,jdbcType=VARCHAR},
            </if>
            <if test="livingWay != null">
                living_way = #{livingWay,jdbcType=VARCHAR},
            </if>
            <if test="medicalHistory != null">
                medical_history = #{medicalHistory,jdbcType=VARCHAR},
            </if>
            <if test="otherMedicalHistory != null">
                other_medical_history = #{otherMedicalHistory,jdbcType=VARCHAR},
            </if>
            <if test="smokingHistory != null">
                smoking_history = #{smokingHistory,jdbcType=VARCHAR}
            </if>
            <if test="smokingYears != null">
                smoking_years = #{smokingYears,jdbcType=VARCHAR},
            </if>
            <if test="smokingNumEachDay != null">
                smoking_num_eachday = #{smokingNumEachDay,jdbcType=VARCHAR},
            </if>
            update_time = now()
        </set>
        <where>
            patient_id=#{patientId,jdbcType=VARCHAR}
        </where>
    </update>

</mapper>
